const mongoose = require(\"mongoose\"); const MidCycle = require(\"./models/Midcycle\"); const Contribution = require(\"./models/Contribution\"); mongoose.connect(\"mongodb://localhost:27017/kolocollect\", { useNewUrlParser: true, useUnifiedTopology: true }).then(async () => { try { const userId = \"68245422849db6f9646f56d4\"; // Jack Silver const midcycle = await MidCycle.findOne().where(\"contributionsToNextInLine\").exists(true); console.log(\"Found midcycle:\", midcycle ? midcycle._id : \"None\"); if (midcycle) { console.log(\"Contributions to next in line map keys:\", Object.keys(midcycle.contributionsToNextInLine.toJSON())); console.log(\"Value for Jack Silver:\", midcycle.contributionsToNextInLine.get(userId) || \"Not found\"); const contributions = await Contribution.find({userId}); console.log(\"Contributions count for Jack Silver:\", contributions.length); console.log(\"Total amount:\", contributions.reduce((sum, c) => sum + parseFloat(c.amount.toString()), 0)); } } catch (err) { console.error(\"Error:\", err); } finally { mongoose.disconnect(); } }).catch(err => console.error(\"Connection error:\", err));
